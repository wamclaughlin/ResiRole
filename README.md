# ResiRole
Estimate protein structure model quality by comparing functional predictions in structure models to experimental reference structures

Welcome to ResiRole
#############################

The set of scripts presented here contain a method for assessing the quality of protein homology models based on the precision with which they reconstitute functional site predictions around specific residues as found in their experimentally determined target structures. These predictions are made on the basis of physiochemical properties as analyzed by the FEATURE program (), an algorithm trained to score the residues in any given structure model according to functional site motifs. ResiRole provides, we believe, an objective measurement of the degree to which physiochemical environments are conserved between any given structure model and its experimentally determined reference structure.

ResiRole is designed to provide information relating to the performance of various structure prediction techniques (modelling servers) over different time spans. Our metrics can rank the general performance of techniques relative to each other as well as provide information regarding techniques' performance on particular structures.

For more information about our methodology and our algorithms, please see the following publication: ResiRole: Residue-Level Functional Site Predictions to Gauge the Accuracies of Protein Structure Prediction Techniques. Joshua M. Toth, Paul J. Depietro, Juergen Haas, and William A. McLaughlin. (Publication Under Review).

General Algorithm Overview:

FEATURE program is run on both the structure models and corresponding target structures to be analyzed
Resulting functional prediction scores are parsed into specificity thresholds based on benchmarking
An ROC curve study is performed to determine the optimum cutoff specificity above which to use functional predictions for subsequent analysis
For each technique considered, Difference Score and Correlation Score metrics are calculated and averaged.
Techniques are assessed in a head-to-head manner by calculating these same metrics across their common set of target structures.
About FEATURE: FEATURE is an algorithm trained on structures with known functional site motifs annotated by PROSITE () that can score a given structure model for the likeliness it possesses a given functional site based on the physiochemcial properties present. FEATURE evaluates these properties by sampling concentric shells of set distances around an anchor residue within the functional site motif. This anchor residue is a highly conserved residue across structures containing the particular type of functional site. Accordingly, any residue of a particular type in a structure model could be scored by FEATURE using all functional site motifs which have that same type of residue as an anchor. For a complete description of the program, please see www.simtk.org/projects/feature. We do not provide the FEATURE program with these scripts. Anyone interested in obtaining its source code can contact the developers. Within the scripts are clear directions regarding the directory setup once FEATURE is installed. We choose to utilize the FEATURE program for our purposes due to the breadth of types of functional sites available.

About the ROC curve analysis: ResiRole parses the function site prediction Z-scores for structure models and reference structures according to specificity thresholds of 0, 1, 5, 10, 20, 30, 40, 50, 60, 70, 80, 90, 95, 99, and 100 percent based on Z-score the specificity correspondences identified by a previous benchmarking study. A receiver-operator characteristic (ROC) curve analysis is performed in which those predictions in the reference structure that make it to the 100% specificity threshold are considered the "gold standard positives" set. The remaining predictions in the reference structures are considered as negatives. Each model's scores are tallied accordingly, and the resulting ROC curves are analyzed for the benchmarking specificity at which Youden's index is a maximum. All model predictions at or above this specificity threshold are used for subsequent analyses.

About the calculated metrics: We define two metrics as the result of the analyses. The Difference Score is calculated as the absolute value of the difference between the functional site prediction probability in a structure model versus the functional site prediction probability at the corresponding site in the experimental structure. A difference score is obtained for each instance of a functional site prediction that is made for each residue of each structure model. An average Difference Score and its standard deviation are calculated for each structure prediction technique by averaging the difference scores for the function site predictions across all the models produced by that structure prediction technique in the given time frame. A Correlation Score is defined as the Pearson's r value associated with a linear regression fit of the plot of all reference structures' functional site prediction probabilities versus all structure models' functional site prediction probabilities for each type of functional site. An average and standard deviation of this metric is then obtained for each structure prediction technique by converting the Pearson r values to Z-scores and averaging across all types of functional sites. The average Pearson r value then reported is the back-converted average Z-score. The Difference Score and Correlation Score are therefore related as follows: the Difference Score for a particular functional site prediction is the absolute value of the difference between the x and y values of a point on a plot of reference structure versus structure model functional site prediction probabilities for that type of function prediction. The Correlation Score is the Pearson r value from a linear regression of that plot.

About weekly automation: The Protein Data Bank (PDB) () releases all of the experimentally determined structures received from the scientific community at large on a weekly cycle. In coordination with the weekly update cycle of the PDB, the Continuous Automated Model Evaluation (CAMEO) server () receives primary sequences of the structures to be released and provides these sequences to all participating structure prediction technique servers (modeling servers). The resulting structure models produced by each structure prediction technique are collected and made available to the public via the CAMEO site. At any given time, CAMEO's public archives are available for the previous year's worth of data regarding the experimentally determined structures obtained from the PDB and the structure models produced by each structure prediction technique. Each week, the automated ResiRole pipeline retrieves the current year's worth of data and analyzes the models produced by each structure prediction technique over selected time intervals which extend back over a full year, six months, three months, one month, and one week.

It is important to note that the scripts provided here are designed to utilize the metrics output by ResiRole to assess the accuracy of structure prediction techniques in an automated manner over different time frames. These scripts run locally on our computing cluster and provide the data included in weekly updates to our webpage (www.protein.som.geisinger.edu/ResiRole/). As such, the following aspects are included within the scripts but are not essential to the process of estimating model quality with ResiRole:

- Synchronization of date ranges for the various time intervals
- Archiving of results from structures released prior to the most recent year's worth of data
- Parallel processing of several steps within the pipeline for efficiency, including running FEATURE, performing the
ROC analysis, and calculating the metrics for individual servers as well as head-to-head server comparisons. We
utilize a Rocks Sun Grid Engine () computing cluster for parallel processing, and these scripts could easily be
modified to work in conjunction with other forms of parallel processing, or none at all.
This pipeline accepts input structure's atomic coordinate data in the format of CAMEO download files, but is not restricted to the number of structures provided or the time frame. The significance of the resulting output, however, is dependent on the number of structures examined, and the pipeline overall is most suited to long-term analysis of modelling techniques.

The accompanying study () was performed using approximately four years' worth of data from CAMEO ranging from May 30, 2014 to Feb 24, 2018 (available upon request from CAMEO). Results in this study were obtained utilizing the exact same algorithms in these scripts without the overarching separation of data into time frames. The scripts are currently set up to retrieve the most recent three-month download from CAMEO.

Please contact us with any comments, concerns, or requests of additional information:

If you utilize these scripts for your work, please cite the following reference: ResiRole: Residue-Level Functional Site Predictions to Gauge the Accuracies of Protein Structure Prediction Techniques. Joshua M. Toth, Paul J. Depietro, Juergen Haas, and William A. McLaughlin. (Publication Under Review).

These scripts are provided under an Open Source licence. The ResiRole name is protected by international copyright, trademark, and other laws. You may download and modify these scripts for your personal use provided that you keep intact all authorship, copyright, and other proprietary notices. In addition, please refer to the licencing conditions and policies of CAMEO and FEATURE. 
